@model IEnumerable<Agenda.Models.ModeloAgenda>

@{
    ViewData["Title"] = "Agenda Mobile";
}

<div class="container mobile-agenda">
    <!-- Cabeçalho simplificado para mobile -->
    <div class="row mb-3">
        <div class="col-12 d-flex align-items-center">
            <h4 class="mb-0 me-3">Agenda</h4>
            <div class="d-flex align-items-center">
                <button class="btn btn-outline-secondary btn-sm me-2" onclick="ajustarData(-1)" style="padding: 0.25rem 0.5rem;">
                    <span style="font-size: 1.2em;">◀</span>
                </button>
                <input type="date" id="dataSelecionada" class="form-control form-control-sm"
                       style="width: auto;"
                       value="@DateTime.Today.ToString("yyyy-MM-dd")" />
                <button class="btn btn-outline-secondary btn-sm ms-2" onclick="ajustarData(1)" style="padding: 0.25rem 0.5rem;">
                    <span style="font-size: 1.2em;">▶</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Container da agenda mobile -->
    <div class="agenda-mobile-container">
        <!-- Lista de itens em uma única coluna -->
        <div class="agenda-items-mobile">
            @foreach (var item in Model)
            {
                <div class="agenda-item-mobile">
                    <span class="agenda-item-title">
                        @item.Titulo
                        @if (!string.IsNullOrEmpty(item.Descricao))
                        {
                            <span class="agenda-item-descricao"> - @item.Descricao</span>
                        }
                    </span>
                </div>
            }
        </div>
    </div>
</div>

<!-- Modal para mostrar detalhes (mesmo do desktop) -->
<div class="modal fade" id="detalhesModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Detalhes</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body" id="modalBodyContent">
                <!-- A descrição será inserida aqui via JavaScript -->
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button>
            </div>
        </div>
    </div>
</div>

@section Styles {
    <style>
        .mobile-agenda {
            padding: 10px;
            max-width: 100%;
        }

        .agenda-mobile-container {
            position: relative;
            min-height: 70vh;
            background-image: url('/imagens/Agenda.jpg');
            background-size: cover;
            background-repeat: no-repeat;
            background-position: center;
            border-radius: 10px;
            padding: 20px;
            margin-top: 10px;
            overflow: hidden;
        }

        .agenda-items-mobile {
            position: absolute;
            top: 15%;
            left: 10%;
            right: 10%;
            bottom: 10%;
            overflow-y: auto;
        }

        .agenda-item-descricao {
            font-size: 0.9em;
            color: #555;
            font-family: Arial, sans-serif;
            font-weight: normal;
        }

        .agenda-item-mobile {
            margin-bottom: 23.5px;
            font-size: 1.1em;
            font-weight: bold;
            color: #333;
            font-family: 'Brush Script MT', 'Segoe Script', cursive;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .date-input-mobile {
            width: 120px !important;
        }

        .details-btn-mobile {
            padding: 0.2rem 0.4rem;
            opacity: 0.9;
        }

        /* Ajustes para telas muito pequenas */
        @@media (max-width: 400px) {
            .agenda-item-mobile {
                font-size: 1em;
            }

            .date-input-mobile {
                width: 100px !important;
            }
        }
    </style>
}

@section Scripts {
    <script>
        // Funções para navegação de data (iguais ao desktop)
        function ajustarData(dias) {
            const inputData = document.getElementById('dataSelecionada');
            const data = new Date(inputData.value);
            data.setDate(data.getDate() + dias);
            inputData.value = data.toISOString().split('T')[0];
            window.location.href = `?data=${inputData.value}`;
        }

        function mostrarDetalhes(descricao) {
            document.getElementById('modalBodyContent').innerText = descricao;
            var myModal = new bootstrap.Modal(document.getElementById('detalhesModal'));
            myModal.show();
        }

        document.getElementById('dataSelecionada').addEventListener('change', function () {
            const dataSelecionada = this.value;
            window.location.href = `?data=${dataSelecionada}`;
        });

        // Carrega a data da URL se existir
        const urlParams = new URLSearchParams(window.location.search);
        const dataParam = urlParams.get('data');
        if (dataParam) {
            document.getElementById('dataSelecionada').value = dataParam;
        }
    </script>
}